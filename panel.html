<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Panel de contrôle - FireWolf</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter&display=swap');
  body {
    margin:0; padding:2rem;
    font-family: 'Inter', sans-serif;
    background-color: #121212;
    color: #eee;
  }
  h1, h2 {
    color: #ffa500;
  }
  #loginForm, #panel {
    max-width: 600px;
    background: #1e1e1e;
    padding: 1rem;
    border-radius: 8px;
  }
  label {
    display: block;
    margin: 1rem 0 0.3rem;
  }
  input[type="password"] {
    width: 100%;
    padding: 0.6rem;
    border-radius: 4px;
    border: none;
    background: #2a2a2a;
    color: #eee;
    font-size: 1rem;
  }
  button {
    margin-top: 1rem;
    padding: 0.7rem 1.5rem;
    background-color: #ffa500;
    border: none;
    border-radius: 4px;
    color: #121212;
    font-weight: bold;
    cursor: pointer;
    font-size: 1.1rem;
  }
  button:hover {
    background-color: #cc8400;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    padding: 0.6rem 0.8rem;
    border-bottom: 1px solid #333;
    text-align: left;
  }
  select {
    background: #2a2a2a;
    color: #eee;
    border: none;
    border-radius: 4px;
    padding: 0.3rem 0.5rem;
    font-size: 1rem;
  }
  .status {
    font-weight: 700;
    padding: 0.2rem 0.5rem;
    border-radius: 3px;
    color: #000;
  }
  .status.En\ cours { background: #2196f3; }
  .status.Terminé { background: #4caf50; }
  .status.Refusé { background: #f44336; }
  .status.En\ attente\ de\ validation { background: #ff9800; }
</style>
</head>
<body>

<h1>Panel de contrôle - FireLabs</h1>

<div id="loginContainer">
  <form id="loginForm">
    <label for="password">Mot de passe :</label>
    <input type="password" id="password" autocomplete="off" required />
    <button type="submit">Se connecter</button>
  </form>
</div>

<div id="panel" style="display:none;">
  <h2>Liste des commandes</h2>
  <table>
    <thead>
      <tr>
        <th>Nom du jeu</th>
        <th>Pseudo</th>
        <th>Email</th>
        <th>Description</th>
        <th>Fichiers</th>
        <th>Statut</th>
      </tr>
    </thead>
    <tbody id="ordersTableBody"></tbody>
  </table>
  <button id="logoutBtn" style="margin-top:1rem; background:#f44336;">Déconnexion</button>
</div>

<script>
  const PASSWORD = "firewolf123456"; // Change le mot de passe ici

  function getOrders() {
    const data = localStorage.getItem('firelabsOrders');
    return data ? JSON.parse(data) : [];
  }

  function saveOrders(orders) {
    localStorage.setItem('firelabsOrders', JSON.stringify(orders));
  }

  const loginForm = document.getElementById('loginForm');
  const loginContainer = document.getElementById('loginContainer');
  const panel = document.getElementById('panel');
  const ordersTableBody = document.getElementById('ordersTableBody');
  const logoutBtn = document.getElementById('logoutBtn');

  function renderPanel() {
    const orders = getOrders();
    ordersTableBody.innerHTML = '';
    if (orders.length === 0) {
      ordersTableBody.innerHTML = '<tr><td colspan="6">Aucune commande.</td></tr>';
      return;
    }
    orders.forEach(order => {
      const tr = document.createElement('tr');

      tr.innerHTML = `
        <td>${order.gameName}</td>
        <td>${order.pseudo}</td>
        <td>${order.email}</td>
        <td title="${order.description}">${order.description.length > 40 ? order.description.slice(0, 40) + '...' : order.description}</td>
        <td>${order.files.length > 0 ? order.files.join(', ') : '-'}</td>
        <td>
          <select data-id="${order.id}">
            <option value="En attente de validation" ${order.status === 'En attente de validation' ? 'selected' : ''}>En attente de validation</option>
            <option value="En cours" ${order.status === 'En cours' ? 'selected' : ''}>En cours</option>
            <option value="Terminé" ${order.status === 'Terminé' ? 'selected' : ''}>Terminé</option>
            <option value="Refusé" ${order.status === 'Refusé' ? 'selected' : ''}>Refusé</option>
          </select>
        </td>
      `;
      ordersTableBody.appendChild(tr);
    });

    // Ajout des listeners sur les selects
    const selects = ordersTableBody.querySelectorAll('select');
    selects.forEach(sel => {
      sel.addEventListener('change', e => {
        const id = Number(e.target.dataset.id);
        const newStatus = e.target.value;
        let orders = getOrders();
        orders = orders.map(o => {
          if (o.id === id) o.status = newStatus;
          return o;
        });
        saveOrders(orders);
      });
    });
  }

  loginForm.addEventListener('submit', e => {
    e.preventDefault();
    const pw = loginForm.password.value;
    if (pw === PASSWORD) {
      loginContainer.style.display = 'none';
      panel.style.display = 'block';
      renderPanel();
      loginForm.reset();
    } else {
      alert("Mot de passe incorrect");
    }
  });

  logoutBtn.addEventListener('click', () => {
    panel.style.display = 'none';
    loginContainer.style.display = 'block';
  });

</script>

</body>
</html>
