<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Commander un jeu - FireLabs</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter&display=swap');
  body {
    margin:0; padding:2rem;
    font-family: 'Inter', sans-serif;
    background-color: #121212;
    color: #eee;
  }
  h1, h2 {
    color: #ffa500;
  }
  form {
    background: #1e1e1e;
    padding: 1rem;
    border-radius: 8px;
    max-width: 500px;
    margin-bottom: 2rem;
  }
  label {
    display: block;
    margin: 0.7rem 0 0.3rem;
  }
  input, textarea {
    width: 100%;
    padding: 0.5rem;
    border-radius: 4px;
    border: none;
    background: #2a2a2a;
    color: #eee;
    font-size: 1rem;
    resize: vertical;
  }
  input[type="file"] {
    padding: 0.3rem;
  }
  button {
    margin-top: 1rem;
    padding: 0.7rem 1.5rem;
    background-color: #ffa500;
    border: none;
    border-radius: 4px;
    color: #121212;
    font-weight: bold;
    cursor: pointer;
    font-size: 1.1rem;
  }
  button:hover {
    background-color: #cc8400;
  }
  ul {
    max-width: 600px;
    padding-left: 0;
    list-style-type: none;
  }
  li {
    background: #1e1e1e;
    margin-bottom: 0.6rem;
    padding: 0.8rem 1rem;
    border-radius: 6px;
  }
  .status {
    font-weight: 700;
    float: right;
    padding: 0.1rem 0.6rem;
    border-radius: 3px;
  }
  .status.En\ cours { background: #2196f3; color: white; }
  .status.Terminé { background: #4caf50; color: white; }
  .status.Refusé { background: #f44336; color: white; }
  .status.En\ attente\ de\ validation { background: #ff9800; color: black; }
  .footer {
    margin-top: 3rem;
    font-size: 0.85rem;
    color: #777;
  }
</style>
</head>
<body>

<h1>Commander un jeu</h1>

<form id="orderForm">
  <label for="email">Email *</label>
  <input type="email" id="email" name="email" required />
  
  <label for="pseudo">Nom ou Pseudo *</label>
  <input type="text" id="pseudo" name="pseudo" required />
  
  <label for="contact">Autre contact (optionnel)</label>
  <input type="text" id="contact" name="contact" placeholder="Téléphone, Discord..." />
  
  <label for="gameName">Nom du jeu *</label>
  <input type="text" id="gameName" name="gameName" required />
  
  <label for="description">Description du jeu *</label>
  <textarea id="description" name="description" rows="4" required></textarea>
  
  <label for="files">Fichiers optionnels (plusieurs possibles)</label>
  <input type="file" id="files" name="files" multiple />
  
  <button type="submit">Valider la commande</button>
</form>

<h2>Liste des jeux commandés</h2>
<ul id="gameList"></ul>

<div class="footer">
  <p>Page publique — Les statuts sont visibles ici.</p>
  <p><a href="panel.html" style="color:#ffa500;">Accéder au panel de contrôle (mot de passe requis)</a></p>
</div>

<script>
  // Fonction pour récupérer les commandes depuis localStorage
  function getOrders() {
    const data = localStorage.getItem('firelabsOrders');
    return data ? JSON.parse(data) : [];
  }

  // Fonction pour enregistrer les commandes dans localStorage
  function saveOrders(orders) {
    localStorage.setItem('firelabsOrders', JSON.stringify(orders));
  }

  // Fonction pour afficher la liste publique
  function renderList() {
    const list = getOrders();
    const ul = document.getElementById('gameList');
    ul.innerHTML = '';
    if (list.length === 0) {
      ul.innerHTML = '<li>Aucune commande pour le moment.</li>';
      return;
    }
    list.forEach(order => {
      const li = document.createElement('li');
      li.textContent = order.gameName;
      const statusSpan = document.createElement('span');
      statusSpan.className = 'status ' + order.status;
      statusSpan.textContent = order.status;
      li.appendChild(statusSpan);
      ul.appendChild(li);
    });
  }

  document.getElementById('orderForm').addEventListener('submit', e => {
    e.preventDefault();
    const email = e.target.email.value.trim();
    const pseudo = e.target.pseudo.value.trim();
    const contact = e.target.contact.value.trim();
    const gameName = e.target.gameName.value.trim();
    const description = e.target.description.value.trim();

    if (!email || !pseudo || !gameName || !description) {
      alert("Merci de remplir tous les champs obligatoires.");
      return;
    }

    // Fichiers : on va juste enregistrer leurs noms (pas possible de stocker fichiers dans localStorage)
    const filesInput = e.target.files;
    const fileNames = [];
    for(let i = 0; i < filesInput.files.length; i++) {
      fileNames.push(filesInput.files[i].name);
    }

    let orders = getOrders();

    // Création de l'objet commande
    const newOrder = {
      id: Date.now(),
      email,
      pseudo,
      contact,
      gameName,
      description,
      files: fileNames,
      status: "En attente de validation"
    };

    orders.push(newOrder);
    saveOrders(orders);

    alert("Commande enregistrée ! Elle est en attente de validation.");
    e.target.reset();
    renderList();
  });

  // Affichage initial
  renderList();
</script>

</body>
</html>
